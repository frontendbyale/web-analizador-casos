---
// src/components/AnalizadorCasos.astro
---
<div class="w-full max-w-6xl mx-auto p-4 md:p-8">
    <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 mb-8">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
            <div class="md:col-span-2">
                <label for="csvFile" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Archivo CSV</label>
                <input type="file" id="csvFile" accept=".csv" class="block w-full text-sm text-slate-500 dark:text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 dark:file:bg-indigo-900/40 file:text-indigo-700 dark:file:text-indigo-300 hover:file:bg-indigo-100 dark:hover:file:bg-indigo-900/60 cursor-pointer">
            </div>
            <div>
                <label for="monthSelect" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Mes</label>
                <select id="monthSelect" class="w-full p-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition text-slate-900 dark:text-slate-200"></select>
            </div>
            <div>
                <label for="yearInput" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Año</label>
                <input type="number" id="yearInput" placeholder="Ej: 2025" min="2000" max="2100" class="w-full p-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition text-slate-900 dark:text-slate-200">
            </div>
        </div>
        <div class="mt-6">
            <button id="processBtn" class="w-full md:w-auto bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-slate-400 dark:disabled:bg-slate-600 disabled:cursor-not-allowed transition-colors">
                Analizar Período
            </button>
        </div>
    </div>

    <div id="results" class="space-y-8"></div>
</div>

<script>
    import Papa from 'papaparse';

    function initializeSelectors() {
        const months = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
        monthSelect.innerHTML = months.map((month, i) => `<option value="${i}">${month}</option>`).join('');
        const now = new Date();
        monthSelect.value = now.getMonth().toString();
        yearInput.value = now.getFullYear().toString();
    }
    initializeSelectors();
    
</script>